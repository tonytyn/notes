我一直有一个疑问，线程池中的线程是被cpu轮流（或按照一定算法）调度执行的，我设置的线程数越多岂不是被调用的几率就越大，程序执行的就越快吗？为什么很多教程中却都说线程池的数量要设置为N+1（逻辑cpu线程数+1）或者2N。

带着这个问题我查询了很多资料终于弄明白了，我之前一致忽略了这样一句话

> 线程间的切换是非常消耗资源的，如果线程数过多，会导致大量cpu时间被浪费在线程的切换成本上

也就是说，线程切换的成本>多线程所带来的被cpu调度几率的收益。这句话有点绕，意思是多加几条线程所带来的《可能被cpu调用的收益》远不如维护这个线程需要成本，我们要做收益大于成本的事情，所以不能盲目的添加线程。

那么N+1或者2N是怎么来的呢？

*N+1*

cpu线程数决定了这个硬件最大的并行执行能力，例如一台电脑是4核8线程，那么同一时刻，最多有8条线程在执行，如果我们的线程池设置了超过8条线程，那么他们永远也不会同时被调用，最多的情况是调用其中的8个。所以，我们的线程池线程数设置成8条线程就可以达到最大效率了。但程序难免会有阻塞或其他报错。为了防止意外情况多加一条线程，在线程池中的线程不正常工作时它可以顶上。

*2N*

尚待研究